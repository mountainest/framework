kafka读写都在leader上，实现了强一致性。ISR机制保证了高可用性。

|          | kafka              | rocketmq                                                                                                                                                                          | pulsar |
|----------|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| ---|
| 云原生      | 否                  | 否                                                                                                                                                                                 | 是 |
| 事务消息     | 否                  | 是                                                                                                                                                                                 |   |
| 写入       | 百万条/秒，小消息合并        | 7万条                                                                                                                                                                               |   |
| 定时消息     | 不支持                | 支持                                                                                                                                                                                |   |
| 消息过滤     | 不支持                | 可以按tag进行消息过滤                                                                                                                                                                      |   |
| 刷盘       | 异步                 | 同步、异步                                                                                                                                                                             |   |
| 延时队列     | 否                  | 是，但是不支持任意时间的延时，只支持以下几个固定的延时等级。所有的延迟消息由producer发出之后，都会存放到同一个topic（SCHEDULE_TOPIC_XXXX）下，不同的延迟级别会对应不同的队列序号，当延迟时间到之后，由定时线程读取转换为普通的消息存的真实指定的topic下，此时对于consumer端此消息才可见，从而被consumer消费。 |   |
| 消息投递的实时性 | 短轮询，实时性取决于轮询间隔     | 长轮询，同push方式的实时性一致，时延只有几毫秒                                                                                                                                                         |   |
| 消费失败重试   | 不支持重试              | 支持重试                                                                                                                                                                              |   |
| 顺序消费     | broker宕机就会乱序       | 不会乱序                                                                                                                                                                              |   |
| 消息回溯     | 理论上可以按照Offset来回溯消息 | 支持按照时间来回溯消息，精度毫秒，例如从一天之前的某时某分某秒开始重新消费消息                                                                                                                                           |   |
| 消息查询     | 不支持                | 支持                                                                                                                                                                                |   |

https://www.cnblogs.com/ynyhl/p/11320797.html

kafka的事务消息是本地事务，遵循acid，类似于数据库的事务。应用场景：1、同时发送多条消息；2、消费消息的同时，再次发送消息。
Rocketmq的事务消息是分布式事务，采用2PC + 定时补偿机制。

### kafka consumer rebalance
* RangeAssignor （默认的）
* RoundRobinAssignor
* StickyAssignor （最新版支持的）

https://zhuanlan.zhihu.com/p/421160954

### kafka consumer offset 提交确认
1. 自动提交
2. 手动提交（同步、异步）
https://www.ahfesco.com.cn/affairs/Article.asp?id=3278

kafka的副本只是备份功能，不提供读的能力。